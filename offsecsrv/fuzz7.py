#!/usr/bin/python                                                                                 
																										 
from boofuzz import *                                                                                        
																												   
host = '10.10.11.8'     #windows VM                                                                                  
port = 4321             #vulnserver port                                                                                
csv_log = open('fuzz_results.csv', 'wb')                                                                                  
my_logger = [FuzzLoggerCsv(file_handle=csv_log)]



def main():
		session = Session(target = Target(connection = SocketConnection(host, port, proto='tcp')), fuzz_loggers=my_logger, crash_threshold_element= 1, sleep_time=0.1, index_start=700, index_end=775)
		s_initialize("helpoffsec")      #just giving our session a name, "TRUN"
		s_string("HELP", fuzzable = False)      #these strings are fuzzable by default, so here instead of blank, we specify 'false'
		s_delim(" ", fuzzable = False)          #we don't want to fuzz the space between "TRUN" and our arg
		s_string("FUZZTHISSTRING")                      #This value is arbitrary as we did not specify 'False' for fuzzable. Boofuzz will fuzz this string now
		s_string("\r\n", fuzzable = False)
		session.connect(s_get("helpoffsec"))            #having our 'session' variable connect following the guidelines we established in "TRUN"
		session.fuzz()                          #calling this function actually performs the fuzzing
if __name__ == "__main__":
	main()
